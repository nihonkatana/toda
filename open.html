<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>戸田｜掲示場ナビをひらく</title>
    <style>
        :root {
            --pad: 18px;
        }

        body {
            margin: 0;
            background: #fff;
            color: #111;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
        }

        .wrap {
            max-width: 720px;
            margin: 0 auto;
            padding: 20px var(--pad) 30px;
        }

        .title {
            font-weight: 900;
            line-height: 1.2;
            font-size: 30px;
            margin: 6px 0 10px;
        }

        .sub {
            font-size: 18px;
            line-height: 1.5;
            margin: 0 0 14px;
            color: #111;
        }

        .card {
            border: 2px solid #e5e5e5;
            border-radius: 18px;
            padding: 14px;
            margin: 14px 0;
        }

        .warn {
            border-color: #bfe6bf;
            background: #f3fff3;
        }

        .device {
            font-size: 18px;
            font-weight: 900;
            margin: 0 0 6px;
        }

        .hint {
            font-size: 16px;
            line-height: 1.6;
            margin: 0;
            color: #222;
        }

        .bigbtn {
            display: block;
            width: 100%;
            padding: 18px 14px;
            border-radius: 18px;
            text-align: center;
            text-decoration: none;
            font-weight: 900;
            font-size: 24px;
            border: 2px solid #111;
            background: #111;
            color: #fff;
            box-sizing: border-box;
            margin: 12px 0;
        }

        .bigbtn.secondary {
            background: #fff;
            color: #111;
        }

        .sectionTitle {
            font-size: 20px;
            font-weight: 900;
            margin: 2px 0 8px;
        }

        .steps {
            margin: 0;
            padding-left: 22px;
            font-size: 18px;
            line-height: 1.75;
        }

        .steps li {
            margin: 6px 0;
        }

        .pill {
            display: inline-block;
            padding: 2px 10px;
            border: 2px solid #ccc;
            border-radius: 999px;
            background: #f7f7f7;
            font-weight: 800;
        }

        .small {
            font-size: 14px;
            line-height: 1.6;
            color: #555;
            margin-top: 8px;
        }

        .mono {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 13px;
            word-break: break-all;
            color: #333;
        }

        .hidden {
            display: none;
        }

        .okmsg {
            font-size: 16px;
            color: #0a6;
            font-weight: 800;
            margin-top: 8px;
        }

        hr {
            border: none;
            border-top: 2px solid #eee;
            margin: 14px 0;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="title">戸田（とだ）<br>掲示場ナビ</div>
        <p class="sub">
            この画面（LINEの中）では、消えることがあります。<br>
            <b>Chrome / Safari</b> でひらいてください。
        </p>

        <div class="card warn">
            <div class="device" id="deviceLine">端末を確認中…</div>
            <p class="hint" id="deviceHint">下のボタンを押してください。</p>
        </div>

        <a id="mainBtn" class="bigbtn hidden" href="#">読み込み中…</a>

        <div class="card">
            <div class="sectionTitle">ここで止まるとき</div>
            <ol class="steps" id="steps">
                <li>右上の <span class="pill">︙</span> や <span class="pill">□↑</span> を押す</li>
                <li><b>「Chromeでひらく」</b> または <b>「Safariでひらく」</b> を選ぶ</li>
            </ol>

            <hr>

            <div class="sectionTitle">うまくいかないとき</div>
            <ol class="steps">
                <li><b>「URLをコピー」</b> を押す</li>
                <li>Chrome / Safari をひらく</li>
                <li>上のアドレス欄に <b>はりつける</b></li>
            </ol>

            <a id="copyBtn" class="bigbtn secondary" href="javascript:void(0)">URLをコピー</a>
            <div id="copied" class="okmsg hidden">コピーしました。Chrome/Safariをひらいて はりつけてください。</div>

            <div class="small">コピーされるURL：</div>
            <div id="fullUrl" class="mono"></div>
        </div>

        <div class="small">
            ※ 端末やLINEの表示で文言が少し違う場合があります（「外部ブラウザで開く」等）。
        </div>
    </div>

    <script>
        (function () {
            const ua = navigator.userAgent || "";
            const isAndroid = /Android/i.test(ua);
            const isIOS = /iPhone|iPad|iPod/i.test(ua);

            const baseUrl = location.href.split("#")[0].split("?")[0];
            const navUrl = new URL("./index.html", baseUrl).toString();

            const deviceLine = document.getElementById("deviceLine");
            const deviceHint = document.getElementById("deviceHint");
            const mainBtn = document.getElementById("mainBtn");

            document.getElementById("fullUrl").textContent = navUrl;

            if (isAndroid) {
                deviceLine.textContent = "この端末：Android";
                deviceHint.textContent = "下のボタン → できなければ右上の︙ →「Chromeでひらく」";
                const afterScheme = navUrl.replace(/^https?:\/\//, "");
                const intentUrl = "intent://" + afterScheme + "#Intent;scheme=https;package=com.android.chrome;end";
                mainBtn.textContent = "Chromeでひらく";
                mainBtn.href = intentUrl;
                mainBtn.classList.remove("hidden");
            } else if (isIOS) {
                deviceLine.textContent = "この端末：iPhone";
                deviceHint.textContent = "下のボタン → できなければ右上の□↑ →「Safariでひらく」";
                mainBtn.textContent = "Safariでひらく";
                mainBtn.href = navUrl;
                mainBtn.classList.remove("hidden");
            } else {
                deviceLine.textContent = "この端末：不明";
                deviceHint.textContent = "下のURLをコピーして、Chrome/Safariでひらいてください。";
                mainBtn.textContent = "URLをコピーしてひらく";
                mainBtn.href = navUrl;
                mainBtn.classList.remove("hidden");
            }

            const copyBtn = document.getElementById("copyBtn");
            const copied = document.getElementById("copied");
            copyBtn.addEventListener("click", async () => {
                try {
                    await navigator.clipboard.writeText(navUrl);
                } catch (e) {
                    const ta = document.createElement("textarea");
                    ta.value = navUrl;
                    ta.style.position = "fixed";
                    ta.style.left = "-9999px";
                    document.body.appendChild(ta);
                    ta.select();
                    document.execCommand("copy");
                    document.body.removeChild(ta);
                }
                copied.classList.remove("hidden");
                setTimeout(() => copied.classList.add("hidden"), 2600);
            });
        })();
    </script>
</body>

</html>